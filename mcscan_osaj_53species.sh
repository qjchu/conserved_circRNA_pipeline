# mcscan_osaj_53species.sh
#!/bin/bash
org_name=("aegilops_tauschii" "amborella_trichopoda" "arabidopsis_lyrata" "arabidopsis_thaliana" "beta_vulgaris" "brachypodium_distachyon" "brassica_napus" "brassica_oleracea" "brassica_rapa" "chlamydomonas_reinhardtii" "chondrus_crispus" "corchorus_capsularis" "cucumis_sativus" "cyanidioschyzon_merolae" "dioscorea_rotundata" "galdieria_sulphuraria" "glycine_max" "gossypium_raimondii" "helianthus_annuus" "hordeum_vulgare" "leersia_perrieri" "lupinus_angustifolius" "manihot_esculenta" "medicago_truncatula" "musa_acuminata" "nicotiana_attenuata" "oryza_barthii" "oryza_brachyantha" "oryza_glaberrima" "oryza_glumaepatula" "oryza_indica" "oryza_longistaminata" "oryza_meridionalis" "oryza_nivara" "oryza_punctata" "oryza_rufipogon" "oryza_sativa" "ostreococcus_lucimarinus" "phaseolus_vulgaris" "physcomitrella_patens" "populus_trichocarpa" "prunus_persica" "selaginella_moellendorffii" "setaria_italica" "solanum_lycopersicum" "solanum_tuberosum" "sorghum_bicolor" "theobroma_cacao" "trifolium_pratense" "triticum_aestivum" "triticum_urartu" "vitis_vinifera" "zea_mays")
org_cds=("/data2/chuqj/genomes/ensembl_genomes_v38/fasta/aegilops_tauschii/cds/Aegilops_tauschii.ASM34733v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/amborella_trichopoda/cds/Amborella_trichopoda.AMTR1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/arabidopsis_lyrata/cds/Arabidopsis_lyrata.v.1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/arabidopsis_thaliana/cds/Arabidopsis_thaliana.TAIR10.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/beta_vulgaris/cds/Beta_vulgaris.RefBeet-1.2.2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/brachypodium_distachyon/cds/Brachypodium_distachyon.v1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/brassica_napus/cds/Brassica_napus.AST_PRJEB5043_v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/brassica_oleracea/cds/Brassica_oleracea.v2.1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/brassica_rapa/cds/Brassica_rapa.IVFCAASv1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/chlamydomonas_reinhardtii/cds/Chlamydomonas_reinhardtii.v3.1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/chondrus_crispus/cds/Chondrus_crispus.ASM35022v2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/corchorus_capsularis/cds/Corchorus_capsularis.CCACVL1_1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/cucumis_sativus/cds/Cucumis_sativus.ASM407v2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/cyanidioschyzon_merolae/cds/Cyanidioschyzon_merolae.ASM9120v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/dioscorea_rotundata/cds/Dioscorea_rotundata.TDr96_F1_Pseudo_Chromosome_v1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/galdieria_sulphuraria/cds/Galdieria_sulphuraria.ASM34128v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/glycine_max/cds/Glycine_max.Glycine_max_v2.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/gossypium_raimondii/cds/Gossypium_raimondii.Graimondii2_0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/helianthus_annuus/cds/Helianthus_annuus.HanXRQr1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/hordeum_vulgare/cds/Hordeum_vulgare.Hv_IBSC_PGSB_v2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/leersia_perrieri/cds/Leersia_perrieri.Lperr_V1.4.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/lupinus_angustifolius/cds/Lupinus_angustifolius.LupAngTanjil_v1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/manihot_esculenta/cds/Manihot_esculenta.Manihot_esculenta_v6.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/medicago_truncatula/cds/Medicago_truncatula.MedtrA17_4.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/musa_acuminata/cds/Musa_acuminata.MA1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/nicotiana_attenuata/cds/Nicotiana_attenuata.NIATTr2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_barthii/cds/Oryza_barthii.O.barthii_v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_brachyantha/cds/Oryza_brachyantha.Oryza_brachyantha.v1.4b.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_glaberrima/cds/Oryza_glaberrima.AGI1.1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_glumaepatula/cds/Oryza_glumaepatula.ALNU02000000.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_indica/cds/Oryza_indica.ASM465v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_longistaminata/cds/Oryza_longistaminata.O_longistaminata_v1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_meridionalis/cds/Oryza_meridionalis.Oryza_meridionalis_v1.3.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_nivara/cds/Oryza_nivara.AWHD00000000.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_punctata/cds/Oryza_punctata.AVCL00000000.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_rufipogon/cds/Oryza_rufipogon.OR_W1943.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/oryza_sativa/cds/Oryza_sativa.IRGSP-1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/ostreococcus_lucimarinus/cds/Ostreococcus_lucimarinus.ASM9206v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/phaseolus_vulgaris/cds/Phaseolus_vulgaris.PhaVulg1_0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/physcomitrella_patens/cds/Physcomitrella_patens.ASM242v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/populus_trichocarpa/cds/Populus_trichocarpa.JGI2.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/prunus_persica/cds/Prunus_persica.Prunus_persica_NCBIv2.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/selaginella_moellendorffii/cds/Selaginella_moellendorffii.v1.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/setaria_italica/cds/Setaria_italica.JGIv2.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/solanum_lycopersicum/cds/Solanum_lycopersicum.SL2.50.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/solanum_tuberosum/cds/Solanum_tuberosum.SolTub_3.0.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/sorghum_bicolor/cds/Sorghum_bicolor.Sorghum_bicolor_NCBIv3.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/theobroma_cacao/cds/Theobroma_cacao.Theobroma_cacao_20110822.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/trifolium_pratense/cds/Trifolium_pratense.Trpr.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/triticum_aestivum/cds/Triticum_aestivum.TGACv1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/triticum_urartu/cds/Triticum_urartu.ASM34745v1.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/vitis_vinifera/cds/Vitis_vinifera.IGGP_12x.cds.all.fa" "/data2/chuqj/genomes/ensembl_genomes_v38/fasta/zea_mays/cds/Zea_mays.AGPv4.cds.all.fa")
org_gff3=("/data2/chuqj/genomes/ensembl_genomes_v38/gff3/aegilops_tauschii/Aegilops_tauschii.ASM34733v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/amborella_trichopoda/Amborella_trichopoda.AMTR1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/arabidopsis_lyrata/Arabidopsis_lyrata.v.1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/arabidopsis_thaliana/Arabidopsis_thaliana.TAIR10.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/beta_vulgaris/Beta_vulgaris.RefBeet-1.2.2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/brachypodium_distachyon/Brachypodium_distachyon.v1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/brassica_napus/Brassica_napus.AST_PRJEB5043_v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/brassica_oleracea/Brassica_oleracea.v2.1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/brassica_rapa/Brassica_rapa.IVFCAASv1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/chlamydomonas_reinhardtii/Chlamydomonas_reinhardtii.v3.1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/chondrus_crispus/Chondrus_crispus.ASM35022v2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/corchorus_capsularis/Corchorus_capsularis.CCACVL1_1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/cucumis_sativus/Cucumis_sativus.ASM407v2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/cyanidioschyzon_merolae/Cyanidioschyzon_merolae.ASM9120v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/dioscorea_rotundata/Dioscorea_rotundata.TDr96_F1_Pseudo_Chromosome_v1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/galdieria_sulphuraria/Galdieria_sulphuraria.ASM34128v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/glycine_max/Glycine_max.Glycine_max_v2.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/gossypium_raimondii/Gossypium_raimondii.Graimondii2_0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/helianthus_annuus/Helianthus_annuus.HanXRQr1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/hordeum_vulgare/Hordeum_vulgare.Hv_IBSC_PGSB_v2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/leersia_perrieri/Leersia_perrieri.Lperr_V1.4.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/lupinus_angustifolius/Lupinus_angustifolius.LupAngTanjil_v1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/manihot_esculenta/Manihot_esculenta.Manihot_esculenta_v6.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/medicago_truncatula/Medicago_truncatula.MedtrA17_4.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/musa_acuminata/Musa_acuminata.MA1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/nicotiana_attenuata/Nicotiana_attenuata.NIATTr2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_barthii/Oryza_barthii.O.barthii_v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_brachyantha/Oryza_brachyantha.Oryza_brachyantha.v1.4b.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_glaberrima/Oryza_glaberrima.AGI1.1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_glumaepatula/Oryza_glumaepatula.ALNU02000000.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_indica/Oryza_indica.ASM465v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_longistaminata/Oryza_longistaminata.O_longistaminata_v1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_meridionalis/Oryza_meridionalis.Oryza_meridionalis_v1.3.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_nivara/Oryza_nivara.AWHD00000000.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_punctata/Oryza_punctata.AVCL00000000.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_rufipogon/Oryza_rufipogon.OR_W1943.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/oryza_sativa/Oryza_sativa.IRGSP-1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/ostreococcus_lucimarinus/Ostreococcus_lucimarinus.ASM9206v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/phaseolus_vulgaris/Phaseolus_vulgaris.PhaVulg1_0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/physcomitrella_patens/Physcomitrella_patens.ASM242v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/populus_trichocarpa/Populus_trichocarpa.JGI2.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/prunus_persica/Prunus_persica.Prunus_persica_NCBIv2.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/selaginella_moellendorffii/Selaginella_moellendorffii.v1.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/setaria_italica/Setaria_italica.JGIv2.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/solanum_lycopersicum/Solanum_lycopersicum.SL2.50.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/solanum_tuberosum/Solanum_tuberosum.SolTub_3.0.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/sorghum_bicolor/Sorghum_bicolor.Sorghum_bicolor_NCBIv3.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/theobroma_cacao/Theobroma_cacao.Theobroma_cacao_20110822.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/trifolium_pratense/Trifolium_pratense.Trpr.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/triticum_aestivum/Triticum_aestivum.TGACv1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/triticum_urartu/Triticum_urartu.ASM34745v1.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/vitis_vinifera/Vitis_vinifera.IGGP_12x.38.gff3" "/data2/chuqj/genomes/ensembl_genomes_v38/gff3/zea_mays/Zea_mays.AGPv4.38.gff3")

source activate 
conda activate jcvi

for i in 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52
do
	python -m jcvi.formats.fasta format ${org_cds[i]} ${org_name[i]}\.cds
	python -m jcvi.formats.gff bed --type=mRNA --key=transcript_id ${org_gff3[i]} -o ${org_name[i]}\.bed

	# oryza_sativa
	python -m jcvi.compara.catalog ortholog oryza_sativa ${org_name[i]} --cscore=.9 --no_strip_names --cpus=1
	python -m jcvi.compara.synteny screen --minspan=30 --simple oryza_sativa.${org_name[i]}\.anchors oryza_sativa.${org_name[i]}\.anchors.new
	python -m jcvi.compara.synteny mcscan oryza_sativa.bed oryza_sativa.${org_name[i]}\.lifted.anchors --iter=1 -o oryza_sativa.${org_name[i]}\.i1.blocks

done
conda deactivate
